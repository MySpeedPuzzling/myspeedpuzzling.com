{"version":3,"file":"BoundingBox.js","names":["BoundingBox","options","isShowing","namespace","zoomFactor","containerEl","settings","openClasses","_buildClasses","_buildElement","suffix","classes","ns","push","el","document","createElement","zoomPaneWidth","zoomPaneHeight","appendChild","style","width","Math","round","height","removeChild","percentageOffsetX","percentageOffsetY","triggerRect","pageXOffset","window","pageYOffset","inlineLeft","left","clientWidth","inlineTop","top","clientHeight"],"sources":["../src/js/BoundingBox.js"],"sourcesContent":["import throwIfMissing from \"./util/throwIfMissing\";\nimport { addClasses, removeClasses } from \"./util/dom\";\n\nexport default class BoundingBox {\n  constructor(options) {\n    this.isShowing = false;\n\n    const { namespace = null, zoomFactor = throwIfMissing(), containerEl = throwIfMissing() } = options;\n\n    this.settings = { namespace, zoomFactor, containerEl };\n\n    this.openClasses = this._buildClasses(\"open\");\n\n    this._buildElement();\n  }\n\n  _buildClasses(suffix) {\n    const classes = [`drift-${suffix}`];\n\n    const ns = this.settings.namespace;\n    if (ns) {\n      classes.push(`${ns}-${suffix}`);\n    }\n\n    return classes;\n  }\n\n  _buildElement() {\n    this.el = document.createElement(\"div\");\n    addClasses(this.el, this._buildClasses(\"bounding-box\"));\n  }\n\n  show(zoomPaneWidth, zoomPaneHeight) {\n    this.isShowing = true;\n\n    this.settings.containerEl.appendChild(this.el);\n\n    const style = this.el.style;\n    style.width = `${Math.round(zoomPaneWidth / this.settings.zoomFactor)}px`;\n    style.height = `${Math.round(zoomPaneHeight / this.settings.zoomFactor)}px`;\n\n    addClasses(this.el, this.openClasses);\n  }\n\n  hide() {\n    if (this.isShowing) {\n      this.settings.containerEl.removeChild(this.el);\n    }\n\n    this.isShowing = false;\n\n    removeClasses(this.el, this.openClasses);\n  }\n\n  setPosition(percentageOffsetX, percentageOffsetY, triggerRect) {\n    const pageXOffset = window.pageXOffset;\n    const pageYOffset = window.pageYOffset;\n\n    let inlineLeft = triggerRect.left + percentageOffsetX * triggerRect.width - this.el.clientWidth / 2 + pageXOffset;\n    let inlineTop = triggerRect.top + percentageOffsetY * triggerRect.height - this.el.clientHeight / 2 + pageYOffset;\n\n    if (inlineLeft < triggerRect.left + pageXOffset) {\n      inlineLeft = triggerRect.left + pageXOffset;\n    } else if (inlineLeft + this.el.clientWidth > triggerRect.left + triggerRect.width + pageXOffset) {\n      inlineLeft = triggerRect.left + triggerRect.width - this.el.clientWidth + pageXOffset;\n    }\n\n    if (inlineTop < triggerRect.top + pageYOffset) {\n      inlineTop = triggerRect.top + pageYOffset;\n    } else if (inlineTop + this.el.clientHeight > triggerRect.top + triggerRect.height + pageYOffset) {\n      inlineTop = triggerRect.top + triggerRect.height - this.el.clientHeight + pageYOffset;\n    }\n\n    this.el.style.left = `${inlineLeft}px`;\n    this.el.style.top = `${inlineTop}px`;\n  }\n}\n"],"mappings":"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"}