{#
    Stream for collection removal action from unsolved puzzles page.

    Parameters:
    - puzzle_id: The puzzle ID
    - puzzle_statuses: UserPuzzleStatuses object
    - message: Toast message
    - context: Current context (unsolved-detail)
    - remaining_count: Remaining unsolved puzzles count
    - item (optional): UnsolvedPuzzleItem - if still in some collection
#}

{{ include('_modal_close_stream.html.twig') }}

{% if item is defined %}
    {# Puzzle is still in some collection - replace card with updated dropdown #}
    {{ include('_library_item_stream.html.twig', {
        action: 'replace',
        page_context: 'unsolved',
        item: item,
        puzzle_statuses: puzzle_statuses,
        isOwnProfile: true,
    }) }}
{% else %}
    {# Puzzle is no longer in any collection - remove from unsolved list #}
    {{ include('_library_item_stream.html.twig', {
        action: 'remove',
        page_context: 'unsolved',
        puzzle_id: puzzle_id,
    }) }}
{% endif %}

{# Update the count #}
<turbo-stream action="update" target="unsolved-count">
    <template>{{ remaining_count }}</template>
</turbo-stream>

{# Show empty state if no items remaining #}
{% if remaining_count == 0 %}
<turbo-stream action="update" target="unsolved-list-container">
    <template>
        <div class="text-center py-5">
            <div class="mb-3">
                <i class="bi bi-check-circle fs-1 text-success"></i>
            </div>
            <h4 class="text-muted">{{ 'unsolved_puzzles.empty.title'|trans }}</h4>
            <p class="text-muted">{{ 'unsolved_puzzles.empty.message'|trans }}</p>
        </div>
    </template>
</turbo-stream>
{% endif %}

{{ include('_toast_stream.html.twig', {message: message}) }}
