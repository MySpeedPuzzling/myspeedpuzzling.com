{% trans_default_domain 'emails' %}
{% apply inky_to_html|inline_css(source('@styles/foundation-emails.css')) %}
    <wrapper>
        <container>
            {{ include('emails/_header.html.twig') }}

            <row>
                <columns>
                    <spacer size-sm="24"></spacer>
                    <h3>{{ 'unread_messages.title'|trans }}</h3>
                    <spacer size-sm="8"></spacer>
                </columns>
            </row>

            <row>
                <columns>
                    <p>{{ 'unread_messages.greeting'|trans({'%playerName%': playerName ?? 'Puzzler'}) }}</p>

                    {% if summaries is not empty %}
                        <p>{{ 'unread_messages.intro'|trans }}</p>

                        <ul>
                            {% for summary in summaries %}
                                <li>
                                    {% if summary.puzzleName is not null %}
                                        {{ 'unread_messages.message_line_with_puzzle'|trans({'%count%': summary.unreadCount, '%senderName%': summary.senderName, '%puzzleName%': summary.puzzleName}) }}
                                    {% else %}
                                        {{ 'unread_messages.message_line'|trans({'%count%': summary.unreadCount, '%senderName%': summary.senderName}) }}
                                    {% endif %}
                                </li>
                            {% endfor %}
                        </ul>
                    {% endif %}

                    {% if pendingRequestCount is defined and pendingRequestCount > 0 %}
                        {% if summaries is not empty %}
                            <p>{{ 'unread_messages.pending_requests_also'|trans({'%count%': pendingRequestCount}) }}</p>
                        {% else %}
                            <p>{{ 'unread_messages.pending_requests_only'|trans({'%count%': pendingRequestCount}) }}</p>
                        {% endif %}

                        <center>
                            <button href="{{ url('conversations_list', {tab: 'requests'}) }}">
                                {{ 'unread_messages.view_requests'|trans }}
                            </button>
                        </center>

                        <spacer size-sm="10"></spacer>
                    {% endif %}

                    {% if summaries is not empty %}
                        <center>
                            <button href="{{ url('conversations_list') }}">
                                {{ 'unread_messages.view_messages'|trans }}
                            </button>
                        </center>

                        <spacer size-sm="10"></spacer>
                    {% endif %}

                    {% if unreadNotificationCount is defined and unreadNotificationCount > 0 %}
                        <p>{{ 'unread_messages.notifications_section'|trans({'%count%': unreadNotificationCount}) }}</p>

                        <center>
                            <button href="{{ url('notifications') }}">
                                {{ 'unread_messages.view_notifications'|trans }}
                            </button>
                        </center>

                        <spacer size-sm="10"></spacer>
                    {% endif %}

                    <p><small>{{ 'unread_messages.opt_out'|trans({'%settingsUrl%': url('edit_profile')})|raw }}</small></p>
                </columns>
            </row>

            {{ include('emails/_footer.html.twig') }}
        </container>
    </wrapper>
{% endapply %}
