{% extends 'base.html.twig' %}

{% block canonical %}
    {% set routeName = app.request.attributes.get('_route') %}
    {% set routeParams = app.request.attributes.get('_route_params') %}

    <link rel="canonical" href="{{ url(routeName, routeParams) }}">
{% endblock %}

{% block robots %}
    {# LiveComponent handles URL params - check if any filter is applied via URL #}
    {% set hasFilters = app.request.query.get('search') or app.request.query.get('brand') or app.request.query.get('pieces') or app.request.query.get('tag') %}
    {% if hasFilters %}
        <meta name="robots" content="noindex, nofollow">
    {% else %}
        <meta name="robots" content="index, follow">
    {% endif %}
{% endblock %}

{% block title %}{{ 'puzzle_overview.meta.title'|trans }}{% endblock %}

{% block json_ld %}
{{ parent() }}
<script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Dataset",
    "name": "Speed Puzzling Database",
    "description": "{{ 'puzzle_overview.meta.description'|trans }}",
    "url": "{{ url('puzzles', {'_locale': app.request.locale}) }}",
    "keywords": "{{ 'puzzle_overview.meta.keywords'|trans }}",
    "creator": {
        "@type": "Organization",
        "name": "MySpeedPuzzling"
    },
    "distribution": {
        "@type": "DataDownload",
        "encodingFormat": "text/html",
        "contentUrl": "{{ url('puzzles', {'_locale': app.request.locale}) }}"
    }
}
</script>
{% endblock %}

{% block content %}
    <h1 class="mb-2">{{ 'puzzle_overview.title'|trans }}</h1>

    {{ component('PuzzleSearch') }}
{% endblock %}
